# Cairo Fixed-Length 20 - Sequence Encoder
# Projection: Linear
# Loss: MLM only
# Version: 1

encoder_type: transformer
dataset: cairo
dataset_type: casas
encoder:
  d_model: 512
  n_layers: 6
  n_heads: 8
  d_ff: 2048
  max_seq_len: 512
  dropout: 0.2
  projection_dim: 512
  use_alibi: true
  use_learned_pe: false
  fourier_bands: 12
  metadata:
    categorical_fields:
    - sensor
    - state
    - room_id
    use_coordinates: true
    use_time_deltas: false
    use_time_of_day: true
    coord_norm_x_max: 10.0
    coord_norm_y_max: 10.0
    time_delta_max_seconds: 3600.0
    time_delta_bins: 100
  pooling: cls_mean
  pooling_cls_weight: 0.5
optimizer:
  type: adamw
  learning_rate: 0.0003
  betas:
  - 0.9
  - 0.98
  weight_decay: 0.01
  warmup_ratio: 0.1
  grad_clip_norm: 1.0
training:
  batch_size: 256
  max_epochs: 20
  log_interval: 50
  val_interval: 200
  save_interval: 5000
  metrics_interval: 500
  use_amp: true
  num_workers: 4
  pin_memory: true
  shuffle: true
use_wandb: true
wandb_project: discover-v2-dv1
wandb_entity: null
wandb_name: null
wandb_tags: []
wandb_group: null
wandb_notes: Cairo Fixed-Length 20 - Sequence encoder with Linear projection and MLM only loss
experiment_name: cairo_fl20_seq_discover_v1_mlm_only
output_dir: trained_models/cairo/cairo_fl20_seq_discover_v1_mlm_only
train_data_path: data/processed/casas/cairo/FL_20/train.json
val_data_path: data/processed/casas/cairo/FL_20/val.json
vocab_path: data/processed/casas/cairo/FL_20/vocab.json
train_text_embeddings_path: data/processed/casas/cairo/FL_20/train_embeddings_baseline_clip.npz
val_text_embeddings_path: data/processed/casas/cairo/FL_20/val_embeddings_baseline_clip.npz
sensor_projection:
  type: linear
  dim: 512
text_projection:
  type: linear
  dim: 512
loss:
  clip_weight: 0.0
  temperature_init: 0.07
  learnable_temperature: false
  mlm_weight: 1.0
  use_hard_negatives: false
  hard_negative_memory_size: 4096
  hard_negative_ratio: 0.5
  hard_negative_strategy: mixed
  hard_negative_sampling_temperature: 0.1
mlm:
  mask_prob: 0.3
  mean_span_length: 4.0
  enable_field_blackout: true
  p_transition_seed: 0.3
  strict_corr_mask: true

