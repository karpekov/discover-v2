# Alignment training with Image-based CLIP encoder
# Uses frozen CLIP vision embeddings instead of raw sensor sequences

# Experiment metadata
experiment_name: milan_image_clip
output_dir: trained_models/milan/alignment_image_clip

# Dataset metadata (REQUIRED for image-based encoders)
dataset: milan
dataset_type: casas

# Data paths
train_data_path: data/processed/casas/milan/FL_20/train.json
val_data_path: data/processed/casas/milan/FL_20/val.json
vocab_path: data/processed/casas/milan/FL_20/vocab.json

# Text embeddings (pre-computed - these are caption embeddings, NOT image embeddings)
# Image embeddings are loaded separately from layout_embeddings/ folder
train_text_embeddings_path: data/processed/casas/milan/FL_20/train_embeddings_baseline_clip.npz
val_text_embeddings_path: data/processed/casas/milan/FL_20/val_embeddings_baseline_clip.npz

# Encoder config (image-based CLIP)
encoder_config_path: configs/encoders/transformer_image_clip.yaml
encoder_type: transformer

# Sensor projection head
sensor_projection:
  type: linear
  dim: 512
  hidden_dim: 2048
  num_layers: 2
  dropout: 0.1
  use_bn: false

# Text projection head (optional - none means frozen)
text_projection: null

# Loss configuration
loss:
  clip_weight: 1.0
  mlm_weight: 0.0  # No MLM for pure image-based
  temperature_init: 0.07
  learnable_temperature: true
  use_hard_negatives: false

# Optimizer
optimizer:
  type: adamw
  learning_rate: 0.0003
  weight_decay: 0.01
  betas: [0.9, 0.98]
  warmup_ratio: 0.05
  grad_clip_norm: 1.0

# Training
training:
  max_epochs: 50
  max_steps: null
  batch_size: 128
  use_amp: false  # MPS doesn't support AMP yet
  device: auto
  log_interval: 50
  val_interval: 500
  save_interval: 2000
  metrics_interval: 1000
  num_workers: 0  # MPS doesn't support multiprocessing
  shuffle: true
  pin_memory: false  # MPS doesn't support pinned memory

# Logging
use_wandb: true
wandb_project: discover-v2
wandb_entity: null
wandb_name: milan_image_clip
wandb_tags:
  - image-based
  - clip
  - milan
  - alignment
wandb_notes: "Image-based encoder using frozen CLIP embeddings (512D)"
wandb_group: image_encoders

