{
  "comment": "Milan improved MLM model - Enhanced masking strategy with field blackout, transition seeding, strict correlation, adaptive scheduling, and longer spans. Configured for exactly 3 epochs.",

  "text_model_name": "thenlper/gte-base",
  "d_model": 512,
  "n_layers": 4,
  "n_heads": 8,
  "d_ff": 2048,
  "dropout": 0.3,
  "fourier_bands": 12,
  "max_seq_len": 512,
  "sequence_length": 50,
  "max_captions": 4,
  "caption_types": "long",

  "batch_size": 128,
  "learning_rate": 2e-4,
  "betas": [0.9, 0.98],
  "weight_decay": 0.01,
  "warmup_ratio": 0.1,
  "max_epochs": 8,
  "max_steps": null,
  "grad_clip_norm": 1.0,

  "mlm_weight": 0.5,
  "clip_weight": 0.5,
  "temperature_init": 0.03,
  "learnable_temperature": true,

  "use_hard_negatives": true,
  "hard_negative_memory_size": 2048,
  "hard_negative_ratio": 0.3,
  "hard_negative_strategy": "mixed",
  "hard_negative_sampling_temperature": 0.1,

  "mask_prob": 0.35,
  "mean_span_length": 6.0,

  "enable_field_blackout": true,
  "p_transition_seed": 0.4,
  "strict_corr_mask": true,
  "adaptive_mask": true,
  "mask_acc_threshold": 0.96,
  "adaptive_window_steps": 75,

  "log_interval": 25,
  "val_interval": 500,
  "save_interval": 1000,
  "metrics_interval": 500,
  "metrics_sample_size": 200,
  "output_dir": "src-v2/trained_models/milan_improved_mlm_50",

  "use_wandb": true,
  "wandb_project": "discover-v2",
  "wandb_name": "milan_improved_mlm_50",
  "wandb_tags": ["milan", "improved-mlm", "field-blackout", "transition-masking", "adaptive-schedule", "longer-spans", "balanced-loss"],
  "wandb_notes": "Enhanced MLM with 5 new features: (1) Field blackout - zeros correlated embeddings, (2) Transition-span masking - seeds at activity/room transitions, (3) Strict correlated masking - masks all fields in groups, (4) Adaptive schedule - adjusts difficulty based on accuracy, (5) Longer spans - 6.0 mean length. Balanced 50-50 CLIP-MLM loss.",
  "wandb_group": "milan-enhanced",

  "train_data_path": "data/processed/casas/milan/milan_training_50/train.json",
  "val_data_path": "data/processed/casas/milan/milan_training_50/test.json",
  "vocab_path": "data/processed/casas/milan/milan_training_50/vocab.json",

  "use_amp": false,
  "gradient_checkpointing": false,
  "num_workers": 4
}
